# ðŸš€ å¿«é€Ÿéƒ¨ç½² - å¤åˆ¶ç²˜è´´ç‰ˆ

## ðŸ“‹ éƒ¨ç½²ä¿¡æ¯
- **æœåŠ¡å™¨IP**ï¼š175.24.47.45
- **SSHç”¨æˆ·**ï¼šroot
- **SSHå¯†ç **ï¼šLjx19921022
- **Gitä»“åº“**ï¼šhttps://github.com/lijianxiong1022/lijianxiong.git

---

## ðŸŽ¯ ç¬¬ä¸€æ­¥ï¼šæœ¬åœ°æŽ¨é€ä»£ç åˆ°GitHub

åœ¨æœ¬åœ°Windows PowerShellæ‰§è¡Œï¼š

```powershell
cd E:\360MoveData\Users\86182\Desktop\test1
git branch -M main
git push -u origin main
```

**å¦‚æžœæç¤ºéœ€è¦è®¤è¯**ï¼Œè¯·å…ˆé…ç½®GitHubè®¤è¯ã€‚

---

## ðŸ–¥ï¸ ç¬¬äºŒæ­¥ï¼šæœåŠ¡å™¨ç«¯ä¸€é”®éƒ¨ç½²

### 2.1 è¿žæŽ¥æœåŠ¡å™¨

åœ¨æœ¬åœ°PowerShellæ‰§è¡Œï¼š
```powershell
ssh root@175.24.47.45
# è¾“å…¥å¯†ç ï¼šLjx19921022
```

### 2.2 åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œä¸€é”®éƒ¨ç½²è„šæœ¬

è¿žæŽ¥æœåŠ¡å™¨åŽï¼Œæ‰§è¡Œï¼š

```bash
# ä¸‹è½½å¹¶æ‰§è¡Œå®Œæ•´éƒ¨ç½²è„šæœ¬
cd /tmp
cat > deploy.sh << 'DEPLOYSCRIPT'
# è¿™é‡Œä¼šåŒ…å«å®Œæ•´çš„éƒ¨ç½²è„šæœ¬å†…å®¹
DEPLOYSCRIPT

# æˆ–è€…ç›´æŽ¥ä½¿ç”¨æˆ‘æä¾›çš„è„šæœ¬æ–‡ä»¶
# å…ˆä¸Šä¼  æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤-å®Œæ•´ç‰ˆ.sh åˆ°æœåŠ¡å™¨ï¼Œç„¶åŽï¼š
chmod +x æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤-å®Œæ•´ç‰ˆ.sh
./æœåŠ¡å™¨æ‰§è¡Œå‘½ä»¤-å®Œæ•´ç‰ˆ.sh
```

**æˆ–è€…æ‰‹åŠ¨æ‰§è¡Œä»¥ä¸‹å‘½ä»¤**ï¼š

```bash
# 1. å®‰è£…å¿…è¦è½¯ä»¶
sudo yum update -y
sudo yum install -y python3 python3-pip python3-devel mysql mysql-devel gcc git nginx

# 2. åˆ›å»ºé¡¹ç›®ç›®å½•
sudo mkdir -p /var/www/order-system
sudo chown -R $USER:$USER /var/www/order-system

# 3. é…ç½®æ•°æ®åº“
mysql -u root -p19921022 << EOF
CREATE DATABASE IF NOT EXISTS order_system DEFAULT CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci;
CREATE USER IF NOT EXISTS 'order_user'@'localhost' IDENTIFIED BY 'ljx19921022..';
GRANT ALL PRIVILEGES ON order_system.* TO 'order_user'@'localhost';
FLUSH PRIVILEGES;
EOF

# 4. æ‹‰å–ä»£ç 
cd /var/www/order-system
git clone https://github.com/lijianxiong1022/lijianxiong.git .

# 5. é…ç½®ç”Ÿäº§çŽ¯å¢ƒ
cd backend
cat > .env.production << ENVFILE
USE_SQLITE=False
DB_HOST=localhost
DB_PORT=3306
DB_USER=order_user
DB_PASSWORD=ljx19921022..
DB_NAME=order_system
JWT_SECRET_KEY=prod-secret-key-2024-11-24-175244745-ljx19921022
JWT_ACCESS_TOKEN_EXPIRES=86400
FLASK_ENV=production
FLASK_DEBUG=False
FLASK_HOST=0.0.0.0
FLASK_PORT=5000
ENVFILE

# 6. å®‰è£…ä¾èµ–
pip3 install --user -r requirements.txt

# 7. åˆå§‹åŒ–æ•°æ®åº“
export FLASK_ENV=production
python3 init_db.py

# 8. åˆ›å»ºä¸Šä¼ ç›®å½•
mkdir -p uploads/exception_orders
chmod -R 755 uploads

# 9. é…ç½®æœåŠ¡
sudo cp systemd/order-system.service /etc/systemd/system/
sudo systemctl daemon-reload
sudo systemctl enable order-system
sudo systemctl start order-system

# 10. é…ç½®Nginx
sudo cp ../nginx/order-system.conf /etc/nginx/conf.d/
sudo sed -i 's/your_domain.com/175.24.47.45/g' /etc/nginx/conf.d/order-system.conf
sudo nginx -t
sudo systemctl enable nginx
sudo systemctl start nginx

# 11. é…ç½®é˜²ç«å¢™
sudo firewall-cmd --permanent --add-service=http
sudo firewall-cmd --permanent --add-service=https
sudo firewall-cmd --reload

# 12. æµ‹è¯•
curl http://localhost:5000/api/v1/user/register
```

---

## âœ… éƒ¨ç½²å®Œæˆæ£€æŸ¥

1. **æµ‹è¯•API**ï¼š
```bash
curl http://175.24.47.45/api/v1/user/register
```

2. **è®¿é—®å‰ç«¯**ï¼š
- ç”¨æˆ·ç«¯ï¼šhttp://175.24.47.45
- åŽå°ï¼šhttp://175.24.47.45/admin.html

3. **æ£€æŸ¥æœåŠ¡çŠ¶æ€**ï¼š
```bash
sudo systemctl status order-system
```

---

## ðŸ”„ åŽç»­æ›´æ–°

æœ¬åœ°å¼€å‘å®ŒæˆåŽï¼š

```powershell
# æœ¬åœ°
cd E:\360MoveData\Users\86182\Desktop\test1
git add .
git commit -m "æ›´æ–°è¯´æ˜Ž"
git push origin main
```

```bash
# æœåŠ¡å™¨
cd /var/www/order-system
git pull origin main
cd backend
pip3 install --user -r requirements.txt
sudo systemctl restart order-system
```

